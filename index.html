<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard T√†i Ch√≠nh C√° Nh√¢n | Qu·∫£n L√Ω Thu Chi KRW-VND</title>
    <meta name="description"
        content="Dashboard qu·∫£n l√Ω t√†i ch√≠nh c√° nh√¢n th√¥ng minh: theo d√µi thu nh·∫≠p, chi ti√™u, ng√¢n s√°ch 12 th√°ng, t·ªâ gi√° KRW/VND realtime.">
    <meta name="keywords" content="qu·∫£n l√Ω t√†i ch√≠nh, thu chi, ng√¢n s√°ch, KRW, VND, dashboard">
    <meta name="author" content="Finance Tracker">
    <meta name="theme-color" content="#0f0f1a" id="metaThemeColor">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üí∞</text></svg>">
    <link rel="apple-touch-icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üí∞</text></svg>">
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script type="application/ld+json">
    {"@context":"https://schema.org","@type":"WebApplication","name":"Dashboard T√†i Ch√≠nh","description":"·ª®ng d·ª•ng qu·∫£n l√Ω thu nh·∫≠p v√† chi ti√™u c√° nh√¢n th√¥ng minh","applicationCategory":"FinanceApplication"}
    </script>
</head>

<body>
    <!-- AUTH OVERLAY -->
    <div class="auth-overlay" id="authOverlay">
        <div class="auth-card">
            <div class="auth-header">
                <h2 class="auth-logo">üí∞ Finance Dashboard</h2>
                <p class="auth-subtitle">ƒêƒÉng nh·∫≠p ƒë·ªÉ qu·∫£n l√Ω t√†i ch√≠nh</p>
            </div>
            <form id="authForm" onsubmit="handleAuth(event)">
                <div class="auth-field" id="nameField" style="display:none">
                    <label>H·ªç t√™n</label>
                    <input type="text" id="authName" placeholder="Nguy·ªÖn VƒÉn A" autocomplete="name">
                </div>
                <div class="auth-field">
                    <label>Email</label>
                    <input type="email" id="authEmail" placeholder="email@example.com" required autocomplete="email">
                </div>
                <div class="auth-field">
                    <label>M·∫≠t kh·∫©u</label>
                    <input type="password" id="authPassword" placeholder="T·ªëi thi·ªÉu 6 k√Ω t·ª±" required minlength="6"
                        autocomplete="current-password">
                </div>
                <button type="submit" class="auth-btn primary" id="authSubmitBtn">üîë ƒêƒÉng nh·∫≠p</button>
            </form>
            <div class="auth-divider"><span>ho·∫∑c</span></div>
            <button class="auth-btn google" onclick="handleGoogleLogin()">
                <svg width="18" height="18" viewBox="0 0 24 24">
                    <path fill="#4285F4"
                        d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" />
                    <path fill="#34A853"
                        d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                    <path fill="#FBBC05"
                        d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                    <path fill="#EA4335"
                        d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                </svg>
                ƒêƒÉng nh·∫≠p v·ªõi Google
            </button>
            <div class="auth-toggle">
                <span id="authToggleText">Ch∆∞a c√≥ t√†i kho·∫£n?</span>
                <button type="button" class="auth-link" onclick="toggleAuthMode()" id="authToggleBtn">ƒêƒÉng k√Ω</button>
            </div>
            <div class="auth-error" id="authError"></div>
        </div>
    </div>

    <!-- LOADING OVERLAY -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <p>ƒêang t·∫£i...</p>
    </div>

    <div class="app-wrapper" id="appWrapper" style="display:none">
        <!-- HEADER -->
        <header class="header" role="banner">
            <div class="header-content">
                <div class="header-left">
                    <h1 class="logo">üí∞ Finance Dashboard</h1>
                    <p class="subtitle">Qu·∫£n l√Ω thu nh·∫≠p & chi ti√™u th√¥ng minh</p>
                </div>
                <div class="header-right">
                    <div class="user-badge" id="userBadge">
                        <span class="user-avatar" id="userAvatar">üë§</span>
                        <span class="user-name" id="userName"></span>
                    </div>
                    <button class="logout-btn" onclick="handleLogout()" title="ƒêƒÉng xu·∫•t">
                        <span class="logout-icon">‚¨Ö</span> ƒêƒÉng xu·∫•t
                    </button>
                    <button class="theme-toggle" onclick="toggleTheme()" title="Dark/Light Mode"
                        aria-label="Chuy·ªÉn theme">üåô</button>
                    <div class="date-badge" id="currentDate"></div>
                </div>
            </div>
        </header>

        <main class="main-content" role="main">
            <!-- EXCHANGE RATE BAR -->
            <section class="exchange-bar" aria-label="T·ª∑ gi√° h·ªëi ƒëo√°i">
                <div class="exchange-bar-rate">
                    <div class="exchange-bar-flag">üá∞üá∑ KRW ‚Üí üáªüá≥ VND</div>
                    <div class="exchange-bar-value" id="exchangeRateValue">ƒêang t·∫£i...</div>
                    <div class="exchange-bar-sub" id="exchangeSubtext">1 KRW = ... VND</div>
                    <div class="exchange-status live" id="exchangeStatus"><span class="pulse-dot"></span> ƒêang k·∫øt
                        n·ªëi...</div>
                </div>
                <div class="exchange-bar-rate">
                    <div class="exchange-bar-flag">üá∫üá∏ USD ‚Üí üáªüá≥ VND</div>
                    <div class="exchange-bar-value" id="usdRateValue">ƒêang t·∫£i...</div>
                    <div class="exchange-bar-sub" id="usdSubtext">1 USD = ... VND</div>
                </div>
                <div class="exchange-bar-converter">
                    <div class="converter-row">
                        <span class="converter-label">üá∞üá∑ ‚Ç©</span>
                        <input class="converter-input" type="number" id="krwInput" placeholder="Nh·∫≠p KRW"
                            oninput="convertFromKRW()">
                    </div>
                    <div class="converter-row">
                        <span class="converter-label">üáªüá≥ ‚Ç´</span>
                        <input class="converter-input" type="number" id="vndInput" placeholder="Nh·∫≠p VND"
                            oninput="convertFromVND()">
                    </div>
                    <div class="converter-result" id="converterResult">Nh·∫≠p s·ªë ti·ªÅn ƒë·ªÉ quy ƒë·ªïi</div>
                </div>
            </section>

            <!-- SUMMARY CARDS -->
            <section class="stats-section" aria-label="T·ªïng quan">
                <div class="summary-grid">
                    <article class="summary-card balance">
                        <div class="card-icon">üíé</div>
                        <div class="card-label">S·ªë d∆∞ hi·ªán t·∫°i</div>
                        <div class="card-value" id="totalBalance">0 ‚Ç´</div>
                        <div class="card-sub" id="balanceKRW">‚âà 0 ‚Ç©</div>
                    </article>
                    <article class="summary-card income">
                        <div class="card-icon">üìà</div>
                        <div class="card-label">T·ªïng thu nh·∫≠p</div>
                        <div class="card-value" id="totalIncome">0 ‚Ç´</div>
                        <div class="card-sub" id="incomeKRW">‚âà 0 ‚Ç©</div>
                    </article>
                    <article class="summary-card expense">
                        <div class="card-icon">üìâ</div>
                        <div class="card-label">T·ªïng chi ti√™u</div>
                        <div class="card-value" id="totalExpense">0 ‚Ç´</div>
                        <div class="card-sub" id="expenseKRW">‚âà 0 ‚Ç©</div>
                    </article>
                    <article class="summary-card savings">
                        <div class="card-icon">üéØ</div>
                        <div class="card-label">T·ªâ l·ªá ti·∫øt ki·ªám</div>
                        <div class="card-value" id="savingsRate">0%</div>
                        <div class="card-sub" id="savingsLabel">--</div>
                    </article>
                    <article class="summary-card health" id="healthCard">
                        <div class="card-icon" id="healthIcon">üè•</div>
                        <div class="card-label">S·ª©c kh·ªèe t√†i ch√≠nh</div>
                        <div class="card-value health-score" id="healthScore">--</div>
                        <div class="card-sub" id="healthLabel">Ch∆∞a c√≥ d·ªØ li·ªáu</div>
                    </article>
                </div>
            </section>

            <!-- SAVINGS GOAL -->
            <section class="panel savings-goal-panel" aria-label="M·ª•c ti√™u ti·∫øt ki·ªám">
                <div class="panel-header">
                    <h2 class="panel-title"><span class="icon">üéØ</span> M·ª•c ti√™u ti·∫øt ki·ªám</h2>
                </div>
                <div id="savingsGoalContent">
                    <div class="goal-form" id="goalForm">
                        <input type="text" id="goalName" placeholder="T√™n m·ª•c ti√™u (VD: Mua laptop)" class="goal-input">
                        <div class="goal-amount-wrapper">
                            <input type="number" id="goalAmount" placeholder="S·ªë ti·ªÅn (‚Ç© KRW)" class="goal-input"
                                oninput="previewGoalVND()">
                            <span class="goal-vnd-preview" id="goalVndPreview"></span>
                        </div>
                        <input type="number" id="goalMonths" placeholder="S·ªë th√°ng" class="goal-input" min="1"
                            max="120">
                        <button onclick="addSavingsGoal()" class="goal-add-btn">‚ûï Th√™m</button>
                    </div>
                    <div id="goalsList"></div>
                </div>
            </section>

            <!-- 12-MONTH BUDGET TABLE -->
            <section class="budget-section panel" aria-label="B·∫£ng ng√¢n s√°ch 12 th√°ng">
                <div class="panel-header">
                    <h2 class="panel-title"><span class="icon">üìÖ</span> Ng√¢n S√°ch 12 Th√°ng</h2>
                    <div class="year-selector">
                        <button onclick="changeYear(-1)">‚óÄ</button>
                        <span class="year-label" id="yearLabel">2026</span>
                        <button onclick="changeYear(1)">‚ñ∂</button>
                    </div>
                </div>

                <!-- KRW Dashboard Summary above table -->
                <div class="budget-dashboard" id="budgetDashboard">
                    <div class="budget-dash-item income-dash">
                        <span class="dash-label">üìà T·ªïng Thu nh·∫≠p</span>
                        <span class="dash-value" id="dashTotalIncome">0 ‚Ç©</span>
                    </div>
                    <div class="budget-dash-item expense-dash">
                        <span class="dash-label">üìâ T·ªïng Chi ti√™u</span>
                        <span class="dash-value" id="dashTotalExpense">0 ‚Ç©</span>
                    </div>
                    <div class="budget-dash-item balance-dash">
                        <span class="dash-label">üí∞ C√≤n l·∫°i</span>
                        <span class="dash-value" id="dashTotalBalance">0 ‚Ç©</span>
                    </div>
                    <div class="budget-dash-item savings-dash">
                        <span class="dash-label">üéØ T·ªâ l·ªá ti·∫øt ki·ªám</span>
                        <span class="dash-value" id="dashSavingsRate">0%</span>
                    </div>
                </div>

                <div class="budget-table-container">
                    <table class="monthly-table">
                        <thead>
                            <tr>
                                <th>Th√°ng</th>
                                <th>Thu nh·∫≠p<br><small class="th-pct green">‚Ç© KRW</small></th>
                                <th>Sinh ho·∫°t<br><small class="th-pct blue">35%</small></th>
                                <th>D·ª± ph√≤ng<br><small class="th-pct yellow">45%</small></th>
                                <th>ƒê·∫ßu t∆∞<br><small class="th-pct purple">20%</small></th>
                                <th>Chi ti√™u<br><small class="th-pct red">‚Ç© KRW</small></th>
                                <th>C√≤n l·∫°i</th>
                                <th>D∆∞/Thi·∫øu<br><small class="th-pct green">SH-CT</small></th>
                            </tr>
                        </thead>
                        <tbody id="budgetTableBody"></tbody>
                        <tfoot id="budgetTableFoot"></tfoot>
                    </table>
                </div>
                <div class="table-legend">
                    <div class="table-legend-item">
                        <div class="table-legend-dot" style="background:#74b9ff"></div> Sinh ho·∫°t 35%
                    </div>
                    <div class="table-legend-item">
                        <div class="table-legend-dot" style="background:#ff9f43"></div> D·ª± ph√≤ng 45%
                    </div>
                    <div class="table-legend-item">
                        <div class="table-legend-dot" style="background:#a29bfe"></div> ƒê·∫ßu t∆∞ 20%
                    </div>
                </div>

                <!-- BUDGET OVERVIEW CHART -->
                <div class="budget-chart-section">
                    <h3 class="chart-title">üìä Bi·ªÉu ƒë·ªì t·ªïng quan c√°c th√°ng</h3>
                    <div class="budget-chart-legend">
                        <span class="chart-legend-item"><span class="legend-dot" style="background:#00b894"></span> Thu
                            nh·∫≠p</span>
                        <span class="chart-legend-item"><span class="legend-dot" style="background:#e17055"></span> Chi
                            ti√™u</span>
                        <span class="chart-legend-item"><span class="legend-dot" style="background:#0984e3"></span> Sinh
                            ho·∫°t</span>
                        <span class="chart-legend-item"><span class="legend-dot" style="background:#fdcb6e"></span>
                            D∆∞/Thi·∫øu</span>
                    </div>
                    <div class="budget-chart-container" id="budgetOverviewChart"></div>
                </div>
            </section>
        </main>

        <footer class="footer" role="contentinfo">
            <p>üí∞ Finance Dashboard &copy; 2026 ‚Äî goz ‚òÅÔ∏è</p>
        </footer>
    </div>

    <div class="toast" id="toast"></div>
    <script src="supabase.js"></script>
    <script src="app.js"></script>
</body>

</html>